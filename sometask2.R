B <- matrix(0:0, nrow=20, ncol=20)
M <- matrix(0:0, nrow=20, ncol=20)

B[1,] <- c(0,1,1,1,1,1,1,1,0,1,0,0,1,0,1,0,0,0,1,0)
B[2,] <- c(1,0,1,1,1,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0)
B[3,] <- c(1,1,0,1,1,1,1,0,0,0,0,1,0,1,0,0,1,1,0,0)
B[4,] <- c(1,1,1,0,1,1,1,1,0,0,1,0,0,0,1,0,0,0,0,0)
B[5,] <- c(1,1,1,1,0,1,1,0,0,0,0,0,1,0,0,0,1,0,0,0)
B[6,] <- c(1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,0)
B[7,] <- c(1,1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0)
B[8,] <- c(1,0,0,0,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1)
B[9,] <- c(0,0,0,0,1,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1)
B[10,] <- c(0,0,0,0,0,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1)
B[11,] <- c(0,1,0,0,0,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1)
B[12,] <- c(0,0,0,0,0,0,0,1,1,1,1,0,1,1,1,1,1,1,1,1)
B[13,] <- c(1,0,1,0,0,0,0,1,1,1,1,1,0,1,1,1,1,1,1,1)
B[14,] <- c(0,0,0,1,0,0,0,1,1,1,1,1,1,0,1,1,1,1,1,1)
B[15,] <- c(1,0,0,0,1,0,0,1,1,1,1,1,1,1,0,1,1,1,1,1)
B[16,] <- c(0,0,1,0,0,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1)
B[17,] <- c(0,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,1,1,1)
B[18,] <- c(0,1,0,0,1,0,0,1,1,1,1,1,1,1,1,1,1,0,1,1)
B[19,] <- c(0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,1)
B[20,] <- c(1,0,0,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0)

M[1,] <- c(0,1,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1)
M[2,] <- c(1,0,1,0,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1)
M[3,] <- c(0,1,0,1,0,1,1,1,1,1,0,1,0,1,1,0,1,1,1,1)
M[4,] <- c(0,0,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0)
M[5,] <- c(1,1,1,1,0,1,1,1,0,1,1,1,1,0,1,0,1,1,0,1)
M[6,] <- c(1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,0,0,1,1)
M[7,] <- c(1,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,1,1,1,1)
M[8,] <- c(1,1,1,1,1,0,1,0,1,1,1,1,0,1,1,1,0,1,1,1)
M[9,] <- c(0,1,1,1,0,1,1,1,0,1,0,1,1,0,1,1,1,1,1,1)
M[10,] <- c(1,1,1,0,1,0,1,1,1,0,1,1,1,1,1,1,1,1,0,0)
M[11,] <- c(0,0,0,0,0,0,0,1,1,1,0,1,0,1,1,1,1,1,1,1)
M[12,] <- c(0,0,0,0,0,0,0,1,1,1,1,0,1,1,0,1,1,0,1,1)
M[13,] <- c(0,0,0,0,0,0,0,1,1,1,1,1,0,1,1,1,1,1,0,1)
M[14,] <- c(0,0,0,0,0,0,0,1,1,1,1,1,1,0,1,1,0,0,1,1)
M[15,] <- c(0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,1,1,1,1)
M[16,] <- c(0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,1,1,1,1)
M[17,] <- c(0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,1,1,1)
M[18,] <- c(0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,1,1)
M[19,] <- c(0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,1)
M[20,] <- c(0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0)

summa_string <- function(a){
  s <- 0
  for(i in 1:length(a)){
    s <- s+a[i]
  }
  return(s)
}

for(i in 1:20){
  for(j in 1:20){
    if(M[i,j]==1){
      M[j,i] <- 1
    }
  }
}

for(i in 1:20){
  for(j in 1:20){
    if(B[i,j]==1){
      B[j,i] <- 1
    }
  }
}

summa_matr <- function(A){
  s <- 0
  for(i in 1:nrow(A)){
    for(j in 1:ncol(A)){
      s <- s+A[i,j]
    }
  }
  return(s)
}

criterion <- function(A, K_our, K_against){
  potention <- matrix(c((1:ncol(A)), 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0), nrow=2, ncol=ncol(A), byrow=TRUE)
  for(i in 1:20){
    for(j in K_our){
      if(A[i,j]==0){
        potention[2,i] <- Inf
      }
    }
    if(potention[2,i]!=Inf){
      s <- 0
      for(t in K_against){
        s <- s+A[t,i]
      }
      potention[2,i] <- s
    }
  }
  
  for(i in ncol(potention):1){
    maxi <- 1
    for(m in 1:i){
      if(potention[2,maxi]<potention[2,m]){
        maxi <- m
      }
    }
    if(maxi!=i){
      s1 <- potention[1,i]
      s2 <- potention[2,i]
      potention[1,i] <- potention[1,maxi]
      potention[2,i] <- potention[2,maxi]
      potention[1,maxi] <- s1
      potention[2,maxi] <- s2
    }
  }
  return(potention)
}

main_func <- function(A){
  N <- nrow(A)
  for(i in 1:nrow(A)){
    if(summa_matr(A)<180 | summa_string(A[i,]) < 6 ){
      return("impossible")
    }
  }
  for(i in 1:N){
    K1 <- c()
    K2 <- c()
    for(j in 1:N){
      K1 <- c()
      K2 <- c()
      if(i!=j){
        K1 <- c(K1,i)
        K2 <- c(K2,j)
        for(r in 1:12){
          for(h in 1:N){
            res1 <- criterion(A,K1,K2)
            if(res1[2,h]!=Inf && all(K1!=res1[1,h]) && all(K2!=res1[1,h])){
              K1 <- c(K1, res1[1,h])
              break
            }
          }
          for(h in 1:N){
            res2 <- criterion(A,K2,K1)
            if(res2[2,h]!=Inf && all(K1!=res2[1,h]) && all(K2!=res2[1,h])){
              K2 <- c(K2, res2[1,h])
              break
            }
          }
        }
        if(length(K1)+length(K2)==20){
          result <- list()
          result[[1]] <- K1
          result[[2]] <- K2
          return(result)
        }
      }
    }
  }
  return("impossible")
}

res <- main_func(M)
print(res)